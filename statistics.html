<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Site Statistics</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: sans-serif;
      max-width: 800px;
      margin: 2rem auto;
    }
  </style>
</head>
<body>

<h1>Website Visits</h1>
<canvas id="visitsChart"></canvas>

<script>
async function loadStats() {
  const response = await fetch(
    "https://api.cloudflare.com/client/v4/graphql",
    {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_API_TOKEN"
      },
      body: JSON.stringify({
        query: `
        {
          viewer {
            zones(filter: {zoneTag: "YOUR_ZONE_ID"}) {
              httpRequests1dGroups(limit: 30) {
                date
                sum {
                  visits
                }
              }
            }
          }
        }`
      })
    }
  );

  const data = await response.json();
  const stats = data.data.viewer.zones[0].httpRequests1dGroups;

  const labels = stats.map(d => d.date);
  const visits = stats.map(d => d.sum.visits);

  new Chart(document.getElementById("visitsChart"), {
    type: "line",
    data: {
      labels,
      datasets: [{
        label: "Visits per day",
        data: visits,
        borderWidth: 2
      }]
    }
  });
}

loadStats();
</script>

</body>
</html>
